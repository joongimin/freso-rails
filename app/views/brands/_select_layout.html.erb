<%
@layout = @brand.layouts.last
layout_templates = LayoutTemplate.with_translations(I18n.locale).offset(0).limit(8) if layout_templates.nil?
total_count = LayoutTemplate.all.count if total_count.nil?
@total_page = total_count/8 + 1
current_page = 1 if current_page.nil?
%>

<div class="brands-make-shop-step-1-title"></div>
<%= form_for(@layout, :url => update_layout_brand_path(@brand), :remote => true, :html => {:id => "select_layout"}) do |f| %>
  <%= content_tag :div, :class => "step_content" do %>
    <%= link_to "", layout_templates_list_layout_templates_path(:page_number => current_page - 1, :total_count => total_count, :brand_id => @brand.id), :remote => true, :class => "arrow prev" if current_page != 1 || true %>
    <%= link_to "", layout_templates_list_layout_templates_path(:page_number => current_page + 1, :total_count => total_count, :brand_id => @brand.id), :remote => true, :class => "arrow next" if current_page != @total_page %>
    <div class="item_container">
      <ul class="item_list">
        <% layout_templates.each do |layout_template| %>
          <%= content_tag_for :li, layout_template do %>
            <div class="inner">
              <%= f.radio_button(:layout_template_id, layout_template.id) %>
              <div class="preview_container">
                <%= image_tag(layout_template.image.image_url) if layout_template.image.image? %></br>
              </div>
              <div class="info_container">
                <div class="name"><%= layout_template.name%></div>
                <div class="description"><%= layout_template.description%></div>
                <a class="show_sample"><%= t("brands.show_sample") %></a>
                <div class="made_by"><%= t("brands.made_by", :author => layout_template.user.name) %></div>
              </div>
              <div class="check"></div>
            </div>
            <div class="selected_frame">
              <div class="ribbon"></div>
              <div class="check"></div>
            </div>
          <% end %>
        <% end %>
      </ul>
    </div>
    <div class="bottom_area">
      <%= content_tag :a, nil, :class => "button show_all", :id => "show_all_button", :data => {:"message" => t("brands.show_all.now_under_construction")} do %>
        <%= t("brands.select_layout.show_all") %>
      <% end %>
      <%= content_tag :a, nil, :class => "button go_design_store", :id => "go_design_store_button", :data => {:"message" => t("brands.now_under_construction")} do %>
        <%= t("brands.select_layout.go_design_store") %>
      <% end %>
      <div class="page_indicator"><span class="current_page"><%= current_page %></span>/<%= @total_page %></div>
    </div>
  <% end %>
  <div class="button_area">
    <ul>
      <li class="first">
        <%= link_to t("back"), edit_brand_path(@brand, :transition => "slide_back"), :remote => true, :class => "button cancel" %>
      </li>
      <li>
        <%= f.submit :class => "button confirm", :id => "select_layout_button", :value => t("brands.guide.select_layout") %>
      </li>
    </ul>
  </div>
<% end %>